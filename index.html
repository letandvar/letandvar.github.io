<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content">


  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify-html.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify-css.min.js"></script>


  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#1e1e1e">

  <meta name="title" content="TYGH">
  <meta name="description" content="Lightweight code editor with suggestions for mobile">

 <!-- <link rel="icon" type="image/png" sizes="64x64" href="./ics/tygh64.png"> -->


<link rel="icon" type="image/svg+xml" href="/ics/favicon.svg">

<link rel="icon" type="image/x-icon" href="/ics/favicon.ico">

<link rel="icon" type="image/png" sizes="16x16"
      href="/resizeIcon.js?p=favicon.png&w=16">

<link rel="icon" type="image/png" sizes="32x32"
      href="/resizeIcon.js?p=favicon.png&w=32">

<link rel="apple-touch-icon" sizes="180x180"
      href="/resizeIcon.js?p=favicon.png&w=180">

<link rel="icon" type="image/png" sizes="192x192"
      href="/resizeIcon.js?p=favicon.png&w=192">


  <title>TYGH</title>

  <style>
    ::selection {
      background-color: #ffffff33;
      color: #efefef;
    }

    ::-moz-selection {
      background-color: #ff9900;
      color: #efefef;
    }


    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      font-family: Consolas, "Courier New", monospace;
      background-color: #1e1e1e;
      color: #d4d4d4;
      height: 100dvh;
      display: flex;
      flex-direction: column;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    #bar {
      height: fit-content;
      max-height: 50px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 5px;
      background: #252526;
      border-bottom: 1px solid #2d2d2d;
      gap: 5px;
      padding: 5px;
    }

    .btn {
      background: #2d2d2d;
      border: 1px solid #3c3c3c;
      border-radius: 6px;
      width: 100%;
      max-width: 40px;
      aspect-ratio: 1;
curser: pointer;
    }

    .btn::before {
      display: block;
      content: "";
      width: 100%;
      height: 100%;
      background-size: 50%;
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.7;
    }

    .info::before {
      background-image: url("/ics/ic_menu.png");
      background-size: 55%;
    }

    .fontsz::before {
      background-image: url("/ics/ic_fontSize.png");
      background-size: 70%;
    }

    .clean::before {
      background-image: url("/ics/ic_clean.png");
      background-size: 70%;
    }

    .clear::before {
      background-image: url("/ics/ic_delete.png");
      background-size: 60%;
    }

    .upload::before {
      background-image: url("/ics/ic_upload.png");
    }

    .copy::before {
      background-image: url("/ics/ic_copy.png");
    }

    .download::before {
      background-image: url("/ics/ic_download.png");
    }

    .share::before {
      background-image: url("/ics/ic_share.png");
    }

    .preview::before {
      background-image: url("/ics/ic_preview.png");
      background-size: 70%;
    }

    .btn:active {
      background: #3c3c3c;
    }

    #playIcon {
      width: 20px;
      height: 20px;
      /*background-image: url("./ics/play.png");
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;*/
      opacity: 70%;
    }

    #barFontSize {
      display: none;
      padding: 5px 15px;
      gap: 15px;
      background: #252526;
      border-bottom: 1px solid #2d2d2d;
      align-items: center;
    }

    #fontSizeSeekBar {
      flex: 1;
    }

    #fontValue {
      color: #d4d4d4;
      font-size: 16px;
      font-family: "Arial", "Helvetica", sans-serif;
    }


    #container {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    #editor {
      flex: 1;
      padding: 14px;
      font-size: 10px;
      line-height: 1.6;
      background: #1e1e1e;
      color: #d4d4d4;
      border: none;
      outline: none;
      resize: none;
      caret-color: #ffffff;
      overflow-y: auto;
    }

    #suggestions {
      display: flex;
      align-items: center;
      gap: 5px;
      overflow-x: auto;
      background: #252526;
      border-top: 1px solid #2d2d2d;
      padding: 5px;
      height: 40px;
    }

    #suggestions div {
      height: 100%;
      padding: 10px;
      cursor: pointer;
      background: #2d2d2d;
      border: 1px solid #3c3c3c;
      border-radius: 4px;
      white-space: nowrap;
      font-size: 14px;
      color: #cccccc;
      font-family: "Arial", "Helvetica", sans-serif;
      display: flex;
      align-items: center;
    }

    #suggestions div:active {
      background: #3c3c3c;
    }

    #editor::-webkit-scrollbar,
    #suggestions::-webkit-scrollbar,
    #symbolsContainer::-webkit-scrollbar {
      height: 2px;
    }

    #editor::-webkit-scrollbar-thumb,
    #suggestions::-webkit-scrollbar-thumb,
    #symbolsContainer::-webkit-scrollbar-thumb {
      background: #ffffff33;
    }


    @media (hover:hover) {

      #preview:hover {
        background: #3c3c3c;
      }

      #suggestions div:hover {
        background: #3c3c3c;
        color: #ffffff;
      }

      #symbolsContainer p:hover {
        background: #3c3c3c;
      }

    }

    #symbolsContainer {
      display: flex;
      overflow-x: auto;
      gap: 3px;
      font-family: Consolas, monospace;
      padding: 5px;
      height: fit-content;
      background: #252526;
      border-top: 1px solid #2d2d2d;
    }

    #symbolsContainer p {
      display: inline-block;
      padding: 5px;
      cursor: pointer;
      background: #2d2d2d;
      border: 1px solid #3c3c3c;
      border-radius: 2px;
      color: #d4d4d4;
    }

    #symbolsContainer p:active {
      background: #3c3c3c;
    }

    #barFontSize[hidden] {
      display: flex;
    }
  </style>
</head>

<body>

  <div id="bar">
    <a class="btn info" href="/info.html"></a>
    <div class="btn fontsz" onclick="barFontSize.hidden ^=1"></div>
    <div class="btn clean" onclick="clean()"></div>
    <div class="btn upload" onclick="upload()"></div>
    <div class="btn clear" onclick="clr()"></div>
    <div class="btn copy" onclick="copy()"></div>
    <div class="btn download" onclick="download()"></div>
    <div class="btn share" onclick="share()"></div>
    <a class="btn preview" onclick="preview()"></a>
  </div>

  <div id="barFontSize">
    <input type="range" min="0" max="15" id="fontSizeSeekBar">
    <div id="fontValue">10px</div>
  </div>

  <div id="container">
    <textarea id="editor" placeholder="Write here..." autocapitalize="none">Loading your editor data. This won't take long...</textarea>
    <div id="symbolsContainer"></div>
    <div id="suggestions"></div>
  </div>


  <script>
    let timeout;

    editor.addEventListener("click", () => {
      suggestions.innerHTML = "";
    });

    editor.addEventListener("keydown", (e) => {
      if (["ArrowLeft", "ArrowRight", "ArrowUp", "ArrowDown"].includes(e.key)) {
        suggestions.innerHTML = "";
      }
    });

    editor.addEventListener("blur", () => {
      suggestions.innerHTML = "";
    });

    editor.addEventListener("select", () => {
      suggestions.innerHTML = "";
    });
  </script>


  <script>
    function preview() {
      const blob = new Blob([editor.value], {
        type: "text/html"
      });
      const url = URL.createObjectURL(blob);
      window.open(url, "_blank");
    };


    /*
    //use this method if you use TYGH in your local device bcs urls not work on blob

    function preview() {
      const win = window.open("preview.html", "_blank");
      const htmlContent = editor.value;

      // katsna preview.html load
      const interval = setInterval(() => {
        if (win && !win.closed) {
          try {
            win.postMessage({ content: htmlContent }, location.origin);
            clearInterval(interval);
          } catch (e) {}
        } else {
          clearInterval(interval);
        }
      }, 100);
    }*/
  </script>


  <script>
    let fontSize = parseInt(localStorage.getItem("fontSize")) || 10;

    const fontValue = document.getElementById("fontValue");
    applyFontSize(fontSize);


    fontSizeSeekBar.oninput = () => {
      fontSize = parseInt(fontSizeSeekBar.value) + 5;
      applyFontSize(fontSize);
      localStorage.setItem("fontSize", fontSize);
    }

    function applyFontSize(fs) {
      var toPx = fs + "px";
      editor.style.fontSize = toPx;
      fontValue.innerText = toPx;
      fontSizeSeekBar.value = fs - 5;
    }
  </script>


  <script>
    const worker = new Worker("worker.js");

    worker.postMessage({
      type: "load"
    });

    worker.onmessage = (e) => {
      if (e.data.type === "loaded") {
        editor.value = e.data.content;
      }
    };
  </script>


  <script>
    const symbols = ["#", "*", "(", ")", "[", "]", "/", "\\", "\"", "'", "`", ":", ";", "{", "}", "<", ">", "=", "-", "$", "!", "%", "|", "^"];
    const symbolsContainer = document.getElementById("symbolsContainer");


    symbols.forEach(sym => {
      const p = document.createElement("p");
      p.textContent = sym;

      p.addEventListener("mousedown", (e) => {
        e.preventDefault();

        const pos = editor.selectionStart;
        const before = editor.value.slice(0, pos);
        const after = editor.value.slice(pos);

        editor.value = before + sym + after;

        const newPos = pos + sym.length;
        editor.setSelectionRange(newPos, newPos);
        editor.focus();
        editorEvent();
      });

      symbolsContainer.appendChild(p);
    });
  </script>


  <script>
    function clean() {
      try {
        const code = editor.value;
        const formatted = html_beautify(code, {
          indent_size: 2,
          indent_with_tabs: false,
          preserve_newlines: true,
        });
        editor.value = formatted;
        editorEvent();
      } catch (e) {
        alert("ERR: " + e.message);
      }
    }
  </script>


  <script>
    function download() {
      const name = prompt("Name your file:", "index");

      if (!name) return;

      const content = editor.value;
      const blob = new Blob([content], {
        type: "text/html"
      });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = name.endsWith(".html") ? name : name + ".html";
      a.click();

      URL.revokeObjectURL(url);
    };
  </script>

  <script>
    function copy() {
      try {
        if (navigator.clipboard) {
          navigator.clipboard.writeText(editor.value);
          alert("Code copied!");
        } else {
          alert("Clipboard API not supported in this browser.");
        };
      } catch (e) {
        alert("ERR: " + e.message);
      }
    }
  </script>

  <script>
    function clr() {
      const result = confirm("Do you want to delete the code?");
      if (result) {
        editor.value = "";
        editorEvent();
      }
    }
  </script>

  <script>
    function share() {
      alert("This feature hasn't yet been added.");
    }

    function upload() {
      alert("This feature hasn't yet been added.");
    }

    function info() {
      open("/info.html");
    }

    function editorEvent() {
      clearTimeout(timeout);
      timeout = setTimeout(() => {
        worker.postMessage({
          type: "backup",
          content: editor.value
        });
      }, 300);
    }
  </script>


  <script defer src="/suggs.js"></script>
</body>

</html>